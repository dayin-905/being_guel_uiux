<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì „ì²´ ì •ì±… ë³´ê¸° | ì“±ì“±</title>
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css">
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-orange': '#F48245',
                        'primary-teal': '#4A9EA8',
                        'primary-beige': '#D9B36C'
                    },
                    fontFamily: { sans: ['Pretendard', 'sans-serif'] },
                    screens: {
                        'xs': '500px'
                    },
                    boxShadow: {
                        'floating': '0 20px 40px -5px rgba(0, 0, 0, 0.15), 0 10px 20px -5px rgba(0, 0, 0, 0.1)',
                    }
                }
            }
        }
    </script>
    <style>
        .perspective-wrap {
            perspective: 1000px;
            /* ìì‹ë“¤ì—ê²Œ 3D ê³µê°„ ì œê³µ */
        }

        /* [NEW] ì˜¤ì§ 'ë– ì˜¤ë¥´ëŠ”' ì—­í• ë§Œ í•˜ëŠ” ì¤‘ê°„ ê´€ë¦¬ì */
        .card-lifter {
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            will-change: transform;
            /* ë¶€ë“œëŸ¬ìš´ ì›€ì§ì„ ë³´ì¥ */
        }

        .policy-card {
            transform-style: preserve-3d;
            backface-visibility: hidden;
            -webkit-font-smoothing: antialiased;
            /* íšŒì „ ì‹œ ê³„ë‹¨ í˜„ìƒ ë°©ì§€ */
            transform: translateZ(0);
            width: 100%;
            height: 100%;
        }

        .card-content {
            transform: translateZ(1px);
            /* ì¹´ë“œ ë©´ë³´ë‹¤ ì•„ì£¼ ì‚´ì§ ìœ„ (ê¸€ì ê¹¨ì§ ë°©ì§€) */
            background-color: #fff;
        }

        .card-image {
            transform-style: preserve-3d;
            transform: translateZ(20px);
            /* ì´ë¯¸ì§€ëŠ” ë” íŠ€ì–´ë‚˜ì˜¤ê²Œ */
        }
    </style>
</head>

<body class="bg-gray-50 font-sans">
    <nav style="z-index: 99999; position: sticky; top: 0;"
        class="w-full border-b border-gray-100 bg-white/70 backdrop-blur-md transition-all duration-300">
        <div class="mx-auto flex h-[80px] max-w-[1200px] items-center justify-center md:justify-between px-5">
            <a href="/" class="hidden md:flex items-center transition-opacity hover:opacity-80">
                <img src="/static/images/logo.svg"
                    onerror="this.src='https://placehold.co/100x40/transparent/333?text=LOGO'" alt="Logo"
                    class="h-10 w-auto">
            </a>
            <ul class="hidden xs:flex gap-2 md:gap-3">
                <button id="hamburger-btn"
                    class="xs:hidden absolute right-5 top-1/2 -translate-y-1/2 text-gray-700 hover:text-primary-teal transition-colors p-2">
                    <i class="fa-solid fa-bars text-2xl"></i>
                </button>

                <div id="mobile-menu"
                    class="hidden absolute top-[80px] left-0 w-full bg-white border-b border-gray-100 shadow-lg p-5 flex flex-col gap-3 z-50">
                    <a href="/main.html"
                        class="block w-full text-center py-3 rounded-lg font-bold text-gray-600 hover:bg-gray-50">Home</a>
                    <a href="/all.html"
                        class="block w-full text-center py-3 rounded-lg font-bold text-primary-teal bg-teal-50">All
                        Policies</a>
                    <a href="/mypage.html"
                        class="block w-full text-center py-3 rounded-lg font-bold text-gray-600 hover:bg-gray-50">My
                        Page</a>
                    <a href="/about.html"
                        class="block w-full text-center py-3 rounded-lg font-bold text-gray-600 hover:bg-gray-50">About</a>
                </div>
                <li><a href="/"
                        class="flex items-center justify-center rounded-full px-4 py-2 text-[14px] md:text-[15px] font-bold text-gray-600 bg-gray-100 hover:bg-gray-200 transition-all">Home</a>
                </li>
                <li><a href="/all.html"
                        class="flex items-center justify-center rounded-full px-4 py-2 text-[14px] md:text-[15px] font-bold text-white bg-primary-teal shadow-md transition-all">All
                        Policies</a></li>
                <li><a href="/mypage.html"
                        class="flex items-center justify-center rounded-full px-4 py-2 text-[14px] md:text-[15px] font-bold text-white bg-primary-orange shadow-md hover:bg-[#e06d2e] transition-all">My
                        Page</a></li>
                <li><a href="/about.html"
                        class="flex items-center justify-center rounded-full px-4 py-2 text-[14px] md:text-[15px] font-bold text-white bg-primary-beige shadow-md hover:bg-[#c49f5b] transition-all">About</a>
                </li>
            </ul>
        </div>
    </nav>

    <main class="max-w-[1200px] mx-auto px-5 py-10">
        <header class="text-center mb-16">
            <h1 class="text-3xl md:text-5xl font-extrabold text-gray-900 mb-4 tracking-tight">ì •ì±… ì¹´ë“œ ì»¬ë ‰ì…˜ âœ¨</h1>
            <p class="text-gray-500 text-lg">ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë ¤ë³´ì„¸ìš”! í™”ë©´ í¬ê¸°ì— ë§ì¶° ì¹´ë“œê°€ ë°˜ì‘í•©ë‹ˆë‹¤.</p>

            <div class="max-w-2xl mx-auto mb-6">
                <div
                    class="relative flex items-center w-full h-14 rounded-full focus-within:shadow-lg bg-white overflow-hidden border border-gray-200 shadow-sm transition-shadow duration-300">
                    <div class="grid place-items-center h-full w-12 text-gray-400">
                        <i class="fa-solid fa-magnifying-glass text-lg"></i>
                    </div>
                    <input class="peer h-full w-full outline-none pr-5 text-base bg-transparent placeholder-gray-400"
                        style="color: #1f2937;" type="text" id="search-input"
                        placeholder="í‚¤ì›Œë“œë¥¼ ì…ë ¥í•´ë³´ì„¸ìš” (ì˜ˆ: ì²­ë…„, ì›”ì„¸, ì·¨ì—…)" />
                </div>
            </div>

            <div class="flex gap-2 overflow-x-auto pb-2 justify-center hide-scrollbar" id="category-filters">
                <button
                    class="filter-btn active px-5 py-2 rounded-full bg-gray-800 text-white text-sm font-bold transition-all shadow-md hover:bg-black"
                    data-category="all">ì „ì²´</button>
                <button
                    class="filter-btn px-5 py-2 rounded-full bg-white border border-gray-200 text-gray-600 text-sm font-bold hover:bg-orange-50 hover:text-primary-orange hover:border-primary-orange transition-all"
                    data-category="ì£¼ê±°">ğŸ  ì£¼ê±°</button>
                <button
                    class="filter-btn px-5 py-2 rounded-full bg-white border border-gray-200 text-gray-600 text-sm font-bold hover:bg-teal-50 hover:text-primary-teal hover:border-primary-teal transition-all"
                    data-category="ì·¨ì—…">ğŸ’¼ ì·¨ì—…</button>
                <button
                    class="filter-btn px-5 py-2 rounded-full bg-white border border-gray-200 text-gray-600 text-sm font-bold hover:bg-yellow-50 hover:text-primary-beige hover:border-primary-beige transition-all"
                    data-category="ê¸ˆìœµ">ğŸ’° ê¸ˆìœµ</button>
                <button
                    class="filter-btn px-5 py-2 rounded-full bg-white border border-gray-200 text-gray-600 text-sm font-bold hover:bg-red-50 hover:text-[#FF5A5F] hover:border-[#FF5A5F] transition-all"
                    data-category="ë³µì§€">ğŸ€ ë³µì§€</button>
                <button
                    class="filter-btn px-5 py-2 rounded-full bg-white border border-gray-200 text-gray-600 text-sm font-bold hover:bg-blue-50 hover:text-blue-500 hover:border-blue-500 transition-all"
                    data-category="êµìœ¡">ğŸ“ êµìœ¡</button>
                <button
                    class="filter-btn px-5 py-2 rounded-full bg-white border border-gray-200 text-gray-600 text-sm font-bold hover:bg-purple-50 hover:text-purple-500 hover:border-purple-500 transition-all"
                    data-category="ì°½ì—…">ğŸš€ ì°½ì—…</button>
            </div>
        </header>

        <div id="card-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 pb-10">
        </div>
        <div id="loading-indicator" class="hidden w-full flex justify-center items-center py-10">
            <div class="animate-spin rounded-full h-10 w-10 border-t-4 border-b-4 border-primary-teal"></div>
        </div>

        <div id="no-result" class="hidden text-center py-20">
            <div class="text-6xl mb-4 grayscale opacity-50">ğŸ¤”</div>
            <h3 class="text-xl font-bold text-gray-700 mb-2">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ì–´ìš”.</h3>
            <p class="text-gray-500">ë‹¤ë¥¸ í‚¤ì›Œë“œë¡œ ê²€ìƒ‰í•˜ê±°ë‚˜ í•„í„°ë¥¼ 'ì „ì²´'ë¡œ ë³€ê²½í•´ë³´ì„¸ìš”.</p>
        </div>
    </main>

    <script>
        // --- 1. ìœ í‹¸ë¦¬í‹° & ì„¤ì • ---
        const debounce = (func, delay) => {
            let timeoutId;
            return (...args) => {
                clearTimeout(timeoutId);
                timeoutId = setTimeout(() => func(...args), delay);
            };
        };

        const categoryMap = { "ì£¼ê±°": "housing", "ì·¨ì—…": "job", "ê¸ˆìœµ": "finance", "ë³µì§€": "welfare", "ì°½ì—…": "startup", "êµìœ¡": "growth" };
        const baseData = [
            { id: 1, title: "ì²­ë…„ ì•ˆì‹¬ ì£¼íƒ", category: "ì£¼ê±°", desc: "ì—­ì„¸ê¶Œ ì²­ë…„ ì£¼íƒ ì…ì£¼ì ëª¨ì§‘ ê³µê³ ", colorCode: "#F48245" },
            { id: 2, title: "ì·¨ì—… ì‚¬ê´€í•™êµ", category: "ì·¨ì—…", desc: "SW ê°œë°œì ë°ë·” ê³¼ì • ë¬´ë£Œ êµìœ¡ìƒ ëª¨ì§‘", colorCode: "#4A9EA8" },
            { id: 3, title: "í•™ìê¸ˆ ëŒ€ì¶œ ì´ì", category: "ê¸ˆìœµ", desc: "í•™ìê¸ˆ ëŒ€ì¶œ ì´ì ì „ì•¡ ì§€ì›", colorCode: "#D9B36C" },
            { id: 4, title: "ë§ˆìŒ ê±´ê°• ìƒë‹´ì†Œ", category: "ë³µì§€", desc: "ì „ë¬¸ ì‹¬ë¦¬ ìƒë‹´ì‚¬ì™€ 1:1 ë¬´ë£Œ ìƒë‹´", colorCode: "#FF5A5F" },
            { id: 5, title: "ì „ì„¸ ë³´ì¦ê¸ˆ ë°˜í™˜", category: "ì£¼ê±°", desc: "ì „ì„¸ ì‚¬ê¸° ê±±ì • ì—†ëŠ” ë³´ì¦ë£Œ ì§€ì›", colorCode: "#F48245" },
            { id: 6, title: "ë¯¸ë˜ ì²­ë…„ ì¼ìë¦¬", category: "ì·¨ì—…", desc: "ì‹ ì‚°ì—… ë¶„ì•¼ ê¸°ì—… ë§¤ì¹­ ë° ì¸ê±´ë¹„ ì§€ì›", colorCode: "#4A9EA8" },
            { id: 7, title: "ë¬¸í™” ì˜ˆìˆ  íŒ¨ìŠ¤", category: "ë³µì§€", desc: "ê³µì—°, ì „ì‹œ ê´€ëŒë¹„ 10ë§Œì› ì§€ì›", colorCode: "#FF5A5F" },
            { id: 8, title: "ì²­ë…„ ëŒ€ì¤‘êµí†µë¹„", category: "ê¸ˆìœµ", desc: "ëŒ€ì¤‘êµí†µ ì´ìš©ìš”ê¸ˆ ì¼ë¶€ í™˜ê¸‰", colorCode: "#D9B36C" }
        ];

        // ì´ë¯¸ì§€ ê²½ë¡œ ë§¤í•‘
        const policyData = baseData.map(item => {
            const prefix = categoryMap[item.category] || "welfare";
            const imgIndex = (item.id % 5) + 1;
            item.img = `/static/images/card_images/${prefix}_${imgIndex}.webp`;
            return item;
        });

        // --- 2. 3D íš¨ê³¼ ë¡œì§ (ì™„ì „ ë¶„ë¦¬ êµ¬ì¡°) ---
        function init3DEffect() {
            if (window.innerWidth < 768) return;

            const wrappers = document.querySelectorAll('.perspective-wrap');

            wrappers.forEach(wrapper => {
                if (wrapper.dataset.gsapInitialized) return;
                wrapper.dataset.gsapInitialized = "true";

                // [í•µì‹¬ ë¶„ë¦¬]
                // lifter: ìœ„ì•„ë˜ ì›€ì§ì„ ë‹´ë‹¹
                // card: íšŒì „ ë‹´ë‹¹
                const lifter = wrapper.querySelector('.card-lifter');
                const card = wrapper.querySelector('.policy-card');
                const cardImage = wrapper.querySelector('.card-image img');
                const borderColor = card.dataset.color;

                // Enter: ë¦¬í”„í„°(lifter)ë§Œ ì›€ì§ì„
                wrapper.addEventListener('mouseenter', () => {
                    gsap.set(wrapper, { zIndex: 50 });
                    gsap.to(lifter, {
                        y: -12, // ìœ„ë¡œ ë‘¥ì‹¤
                        scale: 1.05,
                        duration: 0.4,
                        ease: "back.out(1.4)",
                        overwrite: "auto"
                    });
                    gsap.to(card, {
                        borderColor: borderColor,
                        boxShadow: "0 20px 40px -5px rgba(0,0,0,0.2)",
                        duration: 0.3
                    });
                });

                // Move: ì¹´ë“œ(card)ë§Œ íšŒì „ì‹œí‚´ (ë¦¬í”„í„°ëŠ” ê±´ë“œë¦¬ì§€ ì•ŠìŒ -> ì¶©ëŒ ì›ì²œ ë´‰ì‡„)
                wrapper.addEventListener('mousemove', (e) => {
                    const rect = wrapper.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;
                    const centerX = rect.width / 2;
                    const centerY = rect.height / 2;

                    const rotateX = ((y - centerY) / centerY) * -5;
                    const rotateY = ((x - centerX) / centerX) * 5;

                    gsap.to(card, {
                        rotateX: rotateX,
                        rotateY: rotateY,
                        duration: 0.1, // ë°˜ì‘ì†ë„ ë¹ ë¥´ê²Œ
                        ease: "power1.out",
                        overwrite: "auto" // ê°™ì€ ìš”ì†Œë¼ë¦¬ë§Œ ê´€ë¦¬
                    });

                    // ì´ë¯¸ì§€ íŒ¨ëŸ´ë™ìŠ¤ ê°•ë„ ì¡°ì ˆ
                    if (cardImage) {
                        gsap.to(cardImage, {
                            // ê¸°ì¡´ 0.08 -> 0.035 ë¡œ ë³€ê²½ (ì›€ì§ì„ ë²”ìœ„ ì¶•ì†Œ)
                            x: (x - centerX) * 0.05,
                            y: (y - centerY) * 0.05,
                            // durationì„ 0.2 -> 0.4 ë¡œ ëŠ˜ë¦¼ (ë°˜ì‘ ì†ë„ë¥¼ ëŠ¦ì¶°ì„œ ë” ë¬µì§í•˜ê²Œ)
                            duration: 2.0,
                            ease: "power2.out"
                        });
                    }
                });

                // Leave: ë‘˜ ë‹¤ ì›ìƒë³µêµ¬
                wrapper.addEventListener('mouseleave', () => {
                    gsap.delayedCall(0.3, () => gsap.set(wrapper, { zIndex: 1 }));

                    // ë¦¬í”„í„° ë³µêµ¬
                    gsap.to(lifter, { y: 0, scale: 1, duration: 0.5, ease: "power3.out" });

                    // ì¹´ë“œ ë³µêµ¬
                    gsap.to(card, {
                        rotateX: 0, rotateY: 0,
                        borderColor: '#e5e7eb',
                        boxShadow: "0 1px 2px 0 rgba(0, 0, 0, 0.05)",
                        duration: 0.3,
                        ease: "power3.out"
                    });

                    if (cardImage) gsap.to(cardImage, { x: 0, y: 0, duration: 0.3 });
                });
            });
        }

        // ë“±ì¥ ì• ë‹ˆë©”ì´ì…˜ (lifterë¥¼ ì•„ë˜ì—ì„œ ìœ„ë¡œ)
        function playEntranceAnimation() {
            gsap.from(".card-lifter", {
                y: 50,
                opacity: 0,
                duration: 0.6,
                stagger: 0.05,
                ease: "power2.out",
                clearProps: "all" // ì• ë‹ˆë©”ì´ì…˜ ëë‚˜ë©´ ê°„ì„­í•˜ì§€ ì•Šê²Œ ì†ì„± ë‚ ë¦¼
            });
        }

        // --- 3. ë Œë”ë§ í•¨ìˆ˜ (HTML êµ¬ì¡° ë³€ê²½ë¨) ---
        function renderCards(filterCategory = "all", keyword = "", isInitialLoad = false) {
            const container = document.getElementById('card-container');
            const noResult = document.getElementById('no-result');

            const filteredData = policyData.filter(item => {
                const matchCategory = filterCategory === "all" || item.category === filterCategory;
                const matchKeyword = item.title.includes(keyword) || item.desc.includes(keyword) || item.category.includes(keyword);
                return matchCategory && matchKeyword;
            });

            if (filteredData.length === 0) {
                container.innerHTML = "";
                if (noResult) noResult.classList.remove('hidden');
                return;
            }
            if (noResult) noResult.classList.add('hidden');

            // [í•µì‹¬] .perspective-wrap > .card-lifter > .policy-card êµ¬ì¡° ìƒì„±
            container.innerHTML = filteredData.map(item => {
                const itemJson = encodeURIComponent(JSON.stringify(item));
                return `
                <div class="perspective-wrap h-full cursor-pointer group" onclick="openCardModal(this)" data-json="${itemJson}" style="z-index: 1;">
                    <div class="card-lifter">
                        <div class="policy-card relative bg-white rounded-xl overflow-hidden h-full flex flex-col border border-gray-100 shadow-sm transition-colors"
                             data-color="${item.colorCode}">
                            
                            <div class="card-image w-full bg-white flex items-end justify-center shrink-0 h-[200px] overflow-hidden relative">
                                <img src="${item.img}" alt="${item.title}" class="w-full h-full object-cover" onerror="this.src='/static/images/card_images/default.png'">
                            </div>

                            <div class="card-content text-left bg-white flex-grow flex flex-col justify-between p-5 z-20 relative">
                                <div>
                                    <div class="flex items-center gap-2 mb-2">
                                        <span class="text-xs font-bold text-primary-orange bg-orange-100 px-2 py-0.5 rounded">#${item.category}</span>
                                    </div>
                                    <h3 class="card-title mb-2 line-clamp-1 text-xl font-extrabold text-[#222] group-hover:text-primary-teal transition-colors">${item.title}</h3>
                                    <p class="card-desc line-clamp-2 text-sm text-[#666] font-medium leading-relaxed">${item.desc}</p>
                                </div>
                                <div class="card-date flex justify-between items-center mt-4 text-xs text-[#888] border-t pt-3 border-gray-100">
                                    <span>2025.12.31 ë§ˆê°</span>
                                    <i class="fa-solid fa-arrow-right text-gray-300 group-hover:text-primary-teal transition-transform group-hover:translate-x-1"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`;
            }).join('');

            init3DEffect();
            // ì´ˆê¸° ë¡œë“œì´ê±°ë‚˜ ì¹´í…Œê³ ë¦¬ í•„í„° í´ë¦­ì¼ ë•Œë§Œ ë“±ì¥ íš¨ê³¼
            if (isInitialLoad || (keyword === "" && !isInitialLoad)) playEntranceAnimation();
        }

        // --- 4. ì´ˆê¸°í™” ë° ì´ë²¤íŠ¸ ì—°ê²° ---
        document.addEventListener('DOMContentLoaded', () => {
            renderCards("all", "", true);

            const searchInput = document.getElementById('search-input');
            const filterBtns = document.querySelectorAll('.filter-btn');

            if (searchInput) {
                searchInput.addEventListener('input', debounce((e) => {
                    const currentBtn = document.querySelector('.filter-btn.active');
                    const currentCategory = currentBtn ? currentBtn.dataset.category : 'all';
                    renderCards(currentCategory, e.target.value);
                }, 300));
            }

            filterBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    filterBtns.forEach(b => {
                        b.classList.remove('bg-gray-800', 'text-white');
                        b.classList.add('bg-white', 'text-gray-600', 'border');
                    });
                    btn.classList.remove('bg-white', 'text-gray-600', 'border');
                    btn.classList.add('bg-gray-800', 'text-white');
                    btn.classList.add('active');

                    const keyword = searchInput ? searchInput.value : "";
                    renderCards(btn.dataset.category, keyword, false);
                });
            });

            // í–„ë²„ê±° ë©”ë‰´
            const hamburgerBtn = document.getElementById('hamburger-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            if (hamburgerBtn && mobileMenu) {
                hamburgerBtn.addEventListener('click', () => {
                    mobileMenu.classList.toggle('hidden');
                    if (!mobileMenu.classList.contains('hidden')) {
                        gsap.fromTo(mobileMenu, { opacity: 0, y: -20 }, { opacity: 1, y: 0, duration: 0.3 });
                    }
                });
            }
        });

        function openCardModal(element) {
            console.log("ëª¨ë‹¬ ì—´ê¸°:", element.dataset.json);
        }
    </script>
</body>

</html>